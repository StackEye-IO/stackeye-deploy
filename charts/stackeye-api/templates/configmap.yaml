apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "stackeye-api.fullname" . }}-config
  labels:
    {{- include "stackeye-api.labels" . | nindent 4 }}
data:
  # Server configuration
  SERVER_HOST: {{ .Values.config.serverHost | quote }}
  SERVER_PORT: {{ .Values.config.serverPort | quote }}
  SERVER_READ_TIMEOUT: {{ .Values.config.serverReadTimeout | quote }}
  SERVER_WRITE_TIMEOUT: {{ .Values.config.serverWriteTimeout | quote }}
  SERVER_IDLE_TIMEOUT: {{ .Values.config.serverIdleTimeout | quote }}
  DASHBOARD_URL: {{ .Values.config.dashboardURL | quote }}
  # Logging
  LOG_LEVEL: {{ .Values.config.logLevel | quote }}
  LOG_FORMAT: {{ .Values.config.logFormat | quote }}
  # Database pool settings
  DATABASE_MAX_OPEN_CONNS: {{ .Values.config.databaseMaxOpenConns | quote }}
  DATABASE_MAX_IDLE_CONNS: {{ .Values.config.databaseMaxIdleConns | quote }}
  DATABASE_CONN_MAX_LIFETIME: {{ .Values.config.databaseConnMaxLifetime | quote }}
  # JWT token settings
  JWT_ACCESS_TOKEN_EXPIRY: {{ .Values.config.jwtAccessTokenExpiry | quote }}
  JWT_REFRESH_TOKEN_EXPIRY: {{ .Values.config.jwtRefreshTokenExpiry | quote }}
  # Email settings
  EMAIL_PROVIDER: {{ .Values.config.emailProvider | quote }}
  EMAIL_FROM_NAME: {{ .Values.config.emailFromName | quote }}
  EMAIL_FROM_EMAIL: {{ .Values.config.emailFromEmail | quote }}
  # Stripe settings
  STRIPE_ALLOWED_REDIRECT_DOMAINS: {{ .Values.config.stripeAllowedRedirectDomains | quote }}
  # CORS settings
  CORS_ALLOW_ORIGINS: {{ .Values.config.corsAllowOrigins | quote }}
  # Auth0 settings
  {{- if .Values.auth0.enabled }}
  AUTH0_ENABLED: "true"
  AUTH0_DOMAIN: {{ .Values.auth0.domain | quote }}
  AUTH0_AUDIENCE: {{ .Values.auth0.audience | quote }}
  AUTH0_CLIENT_ID: {{ .Values.auth0.clientId | quote }}
  {{- else }}
  AUTH0_ENABLED: "false"
  {{- end }}
