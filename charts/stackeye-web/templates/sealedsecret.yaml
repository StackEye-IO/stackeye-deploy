{{- if .Values.sealedSecrets.enabled }}
# SealedSecret for stackeye-web
# To create: kubectl create secret generic {{ include "stackeye-web.fullname" . }}-secrets \
#   --from-literal=AUTH0_SECRET='...' \
#   --from-literal=AUTH0_CLIENT_SECRET='...' \
#   --dry-run=client -o yaml | kubeseal --format yaml > sealedsecret.yaml
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: {{ include "stackeye-web.fullname" . }}-secrets
  labels:
    {{- include "stackeye-web.labels" . | nindent 4 }}
spec:
  encryptedData:
    {{- range $key, $value := .Values.sealedSecrets.encryptedData }}
    {{ $key }}: {{ $value | quote }}
    {{- end }}
  template:
    metadata:
      name: {{ include "stackeye-web.fullname" . }}-secrets
      labels:
        {{- include "stackeye-web.labels" $ | nindent 8 }}
    type: Opaque
{{- else }}
# Plain Kubernetes Secret (for development only)
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "stackeye-web.fullname" . }}-secrets
  labels:
    {{- include "stackeye-web.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Generate with: openssl rand -hex 32
  AUTH0_SECRET: "replace-with-openssl-rand-hex-32-output"
  AUTH0_CLIENT_SECRET: ""
{{- end }}
